<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>決済フォーム｜バク売れLPテンプレ</title>
    <meta name="robots" content="noindex, nofollow">
    <link rel="icon" href="/bakuure-icon.png">
    <meta property="og:image" content="/bakuure-ogp.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Noto+Sans+JP:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root{--bg:#FAFAFA;--bg-card:#FFF;--bg-alt:#F3F4F6;--border:#E5E7EB;--border-hover:#D1D5DB;--text-primary:#111827;--text-secondary:#6B7280;--text-muted:#7C8290;--accent:#0852FF;--accent-light:rgba(8,82,255,.08);--accent-subtle:rgba(8,82,255,.04);--success:#10B981;--warning:#F59E0B;--danger:#EF4444;--stripe:#635BFF}
        *{box-sizing:border-box;margin:0;padding:0}
        body{font-family:'Inter','Noto Sans JP',-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;background:var(--bg);color:var(--text-primary);line-height:1.7;font-size:16px;-webkit-font-smoothing:antialiased}
        .site-header{position:sticky;top:0;z-index:100;background:rgba(255,255,255,.85);backdrop-filter:saturate(180%) blur(20px);-webkit-backdrop-filter:saturate(180%) blur(20px);border-bottom:1px solid var(--border)}
        .header-inner{max-width:1000px;margin:0 auto;padding:14px 24px;display:flex;align-items:center;justify-content:space-between}
        .header-logo img{height:58px}
        .header-label{font-size:13px;font-weight:600;color:var(--text-secondary);cursor:pointer;transition:color .15s;text-decoration:none}
        .header-label:hover{color:var(--accent)}
        .main{max-width:680px;margin:0 auto;padding:48px 24px 100px}
        .reset-overlay{display:none;position:fixed;inset:0;z-index:1000;background:rgba(0,0,0,.4);backdrop-filter:blur(4px);justify-content:center;align-items:center;padding:24px}
        .reset-overlay.open{display:flex}
        .reset-modal{background:var(--bg-card);border-radius:20px;width:100%;max-width:440px;padding:36px 32px;box-shadow:0 20px 60px rgba(0,0,0,.18);text-align:center}
        .reset-modal .reset-icon{width:56px;height:56px;margin:0 auto 20px;background:rgba(239,68,68,.08);border-radius:50%;display:flex;align-items:center;justify-content:center}
        .reset-modal .reset-icon svg{width:28px;height:28px;color:var(--danger)}
        .reset-modal h3{font-size:18px;font-weight:700;margin-bottom:12px}
        .reset-modal p{font-size:14px;color:var(--text-secondary);line-height:1.8;margin-bottom:24px}
        .reset-modal .reset-actions{display:flex;gap:12px}
        .reset-modal .btn-reset-cancel{flex:1;padding:14px 20px;border-radius:12px;border:1px solid var(--border);background:var(--bg-card);font-size:15px;font-weight:600;font-family:inherit;color:var(--text-primary);cursor:pointer;transition:all .15s}
        .reset-modal .btn-reset-cancel:hover{background:var(--bg-alt)}
        .reset-modal .btn-reset-confirm{flex:1;padding:14px 20px;border-radius:12px;border:none;background:var(--danger);font-size:15px;font-weight:600;font-family:inherit;color:#fff;cursor:pointer;transition:all .15s}
        .reset-modal .btn-reset-confirm:hover{background:#DC2626}
        .page-top{margin-bottom:40px}
        .page-top h1{font-size:32px;font-weight:800;letter-spacing:-.03em;margin-bottom:12px}
        .page-top p{font-size:16px;color:var(--text-secondary);line-height:1.8}
        .plan-group{display:flex;flex-direction:column;gap:12px;margin-bottom:28px}
        .plan-card{display:flex;align-items:flex-start;gap:14px;cursor:pointer;padding:20px;border:2px solid var(--border);border-radius:14px;transition:all .15s;user-select:none;position:relative}
        .plan-card:hover{border-color:var(--border-hover);background:var(--bg-alt)}
        .plan-card.checked{border-color:var(--accent);background:var(--accent-subtle);box-shadow:0 0 0 3px var(--accent-light)}
        .plan-card input[type="radio"]{appearance:none;-webkit-appearance:none;width:22px;height:22px;border:2px solid var(--border);border-radius:50%;flex-shrink:0;margin-top:2px;position:relative;cursor:pointer;transition:all .15s}
        .plan-card input[type="radio"]:checked{background:var(--accent);border-color:var(--accent)}
        .plan-card input[type="radio"]:checked::after{content:'';position:absolute;left:5px;top:5px;width:8px;height:8px;border-radius:50%;background:#fff}
        .plan-info{flex:1}
        .plan-info h3{font-size:17px;font-weight:700;margin-bottom:4px;line-height:1.4}
        .plan-info p{font-size:14px;color:var(--text-secondary);line-height:1.7;margin-bottom:6px}
        .plan-price{font-size:22px;font-weight:800;color:var(--accent)}
        .plan-price span{font-size:13px;font-weight:600;color:var(--text-secondary)}
        .plan-badge{position:absolute;top:-10px;right:16px;font-size:11px;font-weight:700;color:#fff;background:var(--accent);padding:3px 12px;border-radius:100px}
        .form-section{background:var(--bg-card);border:1px solid var(--border);border-radius:16px;padding:32px;margin-bottom:20px;transition:box-shadow .2s}
        .form-section:hover{box-shadow:0 2px 16px rgba(0,0,0,.03)}
        .form-section-label{font-size:11px;font-weight:700;letter-spacing:.08em;text-transform:uppercase;color:var(--accent);background:var(--accent-light);display:inline-block;padding:4px 12px;border-radius:6px;margin-bottom:14px}
        .form-section h2{font-size:24px;font-weight:700;margin-bottom:20px;letter-spacing:-.01em}
        .form-group{margin-bottom:24px}
        .form-group:last-child{margin-bottom:0}
        .form-label{display:block;font-size:16.5px;font-weight:600;margin-bottom:8px}
        .form-label .required{color:var(--danger);font-size:13px;margin-left:4px}
        .form-input{width:100%;padding:12px 16px;border:1px solid var(--border);border-radius:10px;font-size:16px;font-family:inherit;color:var(--text-primary);background:var(--bg-card);transition:border-color .2s,box-shadow .2s;-webkit-appearance:none}
        .form-input:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px var(--accent-light)}
        .form-error{color:var(--danger);font-size:13px;margin-top:6px;display:none}
        .form-error.visible{display:block}
        .form-input.error{border-color:var(--danger)}
        .form-input.error:focus{box-shadow:0 0 0 3px rgba(239,68,68,.15)}
        .btn-proceed{display:inline-flex;align-items:center;gap:10px;font-size:16px;font-weight:700;font-family:inherit;color:#fff;background:var(--accent);padding:18px 48px;border-radius:14px;border:none;cursor:pointer;transition:all .2s;box-shadow:0 4px 20px rgba(8,82,255,.2);margin-top:8px}
        .btn-proceed:hover{background:#063FCC;transform:translateY(-2px);box-shadow:0 8px 28px rgba(8,82,255,.3)}
        .btn-proceed:disabled{background:var(--text-muted);cursor:not-allowed;transform:none;box-shadow:none}
        .btn-proceed svg{width:18px;height:18px}
        .stripe-card{background:linear-gradient(135deg,#f7f7ff 0%,#fafafa 100%);border:1px solid #e0deff;border-radius:14px;padding:28px;text-align:center;margin-top:24px}
        .stripe-card .secure-badge{display:inline-flex;align-items:center;gap:8px;font-size:12px;font-weight:600;color:var(--stripe);background:rgba(99,91,255,.06);padding:6px 16px;border-radius:100px;margin-bottom:20px}
        .stripe-card .secure-badge svg{width:14px;height:14px;fill:currentColor}
        .btn-stripe{display:inline-flex;align-items:center;gap:10px;font-size:16px;font-weight:700;font-family:inherit;color:#fff;background:var(--stripe);padding:18px 40px;border-radius:14px;border:none;cursor:pointer;transition:all .2s;box-shadow:0 4px 20px rgba(99,91,255,.25);text-decoration:none}
        .btn-stripe:hover{background:#4b44d4;transform:translateY(-2px);box-shadow:0 8px 28px rgba(99,91,255,.35)}
        .btn-stripe svg{width:18px;height:18px}
        .stripe-logo{display:flex;align-items:center;justify-content:center;gap:8px;margin-top:16px;font-size:12px;color:var(--text-muted)}
        .stripe-logo img{height:20px}
        .stripe-note{font-size:14px;color:var(--text-muted);line-height:1.8;margin-top:20px;text-align:left}
        .stripe-note p{margin-bottom:8px}
        .site-footer{text-align:center;padding:32px 24px;border-top:1px solid var(--border)}
        .site-footer p{font-size:12px;color:var(--text-muted)}
        @media(max-width:640px){.main{padding:32px 16px 80px}.form-section{padding:24px 20px}.btn-stripe,.btn-proceed{padding:16px 32px;font-size:15px}}
    </style>
</head>
<body>
    <header class="site-header">
        <div class="header-inner">
            <div class="header-logo"><img src="/bakuure-logo.svg" alt="バク売れLPテンプレ"></div>
            <a class="header-label" id="resetFormLink">決済フォーム</a>
        </div>
    </header>
    <main class="main">
        <div id="mainView">
            <div class="page-top">
                <h1>バク売れLPテンプレ 決済フォーム</h1>
            </div>
            <div class="form-section">
                <span class="form-section-label">ステップ 1</span>
                <h2>プランを選択</h2>
                <div class="plan-group">
                    <label class="plan-card checked" id="planAWrap">
                        <input type="radio" name="checkoutPlan" value="starter" id="planA" checked>
                        <div class="plan-info">
                            <h3>A - LP｜スタータープラン</h3>
                            <p>売れる構造をもとに設計されたLPテンプレート。まずは「売れる型」を導入したい方に。</p>
                            <div class="plan-price">¥55,000<span>（税込）</span></div>
                        </div>
                    </label>
                    <label class="plan-card" id="planBWrap">
                        <input type="radio" name="checkoutPlan" value="boost" id="planB">
                        <div class="plan-info">
                            <h3>B - LP＋バナー｜集客強化プラン</h3>
                            <p>LPテンプレート＋バナー素材のセット。販売導線の立ち上げを加速します。</p>
                            <div class="plan-price">¥110,000<span>（税込）</span></div>
                        </div>
                        <span class="plan-badge">おすすめ</span>
                    </label>
                </div>
            </div>
            <div class="form-section">
                <span class="form-section-label">ステップ 2</span>
                <h2>お客様情報を入力</h2>
                <div id="creditStep1">
                    <div class="form-group">
                        <label class="form-label">お客様氏名<span class="required">*</span></label>
                        <input type="text" class="form-input" id="creditName" placeholder="例：山田 太郎" required>
                        <p class="form-error" id="creditNameError">※ お客様氏名が未入力です。</p>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ご契約時にご登録のメールアドレス<span class="required">*</span></label>
                        <input type="email" class="form-input" id="creditEmail" placeholder="例：taro@example.com" required>
                        <p class="form-error" id="creditEmailError">※ 正しいメールアドレスをご入力ください。</p>
                    </div>
                    <div style="text-align:center">
                        <button type="button" class="btn-proceed" id="creditProceedBtn" disabled>
                            <svg viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M8 5v14l11-7z"/></svg>
                            クレジットカードでのお支払いに進む
                        </button>
                    </div>
                </div>
                <div id="creditStep2" style="display:none">
                    <div class="stripe-card">
                        <div class="secure-badge">
                            <svg viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-1 16l-4-4 1.41-1.41L11 14.17l6.59-6.59L19 9l-8 8z"/></svg>
                            セキュアな決済
                        </div>
                        <a href="#" class="btn-stripe" id="stripePayBtn" target="_blank" rel="noopener">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>
                            <span id="stripeBtnLabel">クレジットカードで支払う</span>
                        </a>
                        <div class="stripe-logo">
                            <span>Powered by</span>
                            <img src="/Stripe_Logo,_revised_2016.svg.png" alt="Stripe">
                        </div>
                        <div class="stripe-note">
                            <p>※ Stripeの決済ページに遷移いたしますので、決済をお願いいたします。</p>
                            <p>決済後にStripe登録いただいたメールアドレス宛に、テンプレートのダウンロードリンクをお送りさせていただきます。</p>
                            <p>まれに迷惑メールに入ってしまう場合がございます。<br>決済後1時間経過しても届かない場合は、<a href="mailto:info@chainsoda.world" style="color:var(--accent);font-weight:600">info@chainsoda.world</a> までお問い合わせください。</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <div class="reset-overlay" id="resetOverlay">
        <div class="reset-modal">
            <div class="reset-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg></div>
            <h3>決済フォーム入力を<br>はじめからやり直しますか？</h3>
            <p>これまでに入力した情報は削除されます。</p>
            <div class="reset-actions">
                <button type="button" class="btn-reset-cancel" id="resetCancelBtn">キャンセル</button>
                <button type="button" class="btn-reset-confirm" id="resetConfirmBtn">やり直す</button>
            </div>
        </div>
    </div>
    <footer class="site-footer"><p>&copy; 2026 バク売れLPテンプレ &amp; CHAINSODA Co., Ltd. — All rights reserved.</p></footer>
    <script>
    const CHECKOUT_ENDPOINT='https://script.google.com/macros/s/AKfycbwb3W-2pfK_Ar4fBjoFcMQG7AIjkFn44kCzL5h6xjuRespoZTc25war2TVnZZ7Cgepk/exec';
    const PLANS={
        starter:{name:'A - LP｜スタータープラン',price:55000,label:'¥55,000（税込）',stripeUrl:'https://buy.stripe.com/fZudR24qF5lfbku7235os0h'},
        boost:{name:'B - LP＋バナー｜集客強化プラン',price:110000,label:'¥110,000（税込）',stripeUrl:'https://buy.stripe.com/fZu9AM4qFbJD1JU3PR5os0i'}
    };
    const $=id=>document.getElementById(id);
    const creditName=$('creditName'),creditEmail=$('creditEmail'),creditProceedBtn=$('creditProceedBtn');
    function getSelectedPlan(){return document.querySelector('input[name="checkoutPlan"]:checked').value;}
    function isValidEmail(v){return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);}
    function validateField(input,errorId,testFn){const ok=testFn(input.value);const err=$(errorId);if(err)err.classList.toggle('visible',!ok);input.classList.toggle('error',!ok);return ok;}
    // Plan selection
    document.querySelectorAll('input[name="checkoutPlan"]').forEach(r=>{r.addEventListener('change',()=>{document.querySelectorAll('.plan-card').forEach(c=>c.classList.remove('checked'));r.closest('.plan-card').classList.add('checked');updateStripeBtn();});});
    function updateStripeBtn(){
        const planKey=getSelectedPlan();const plan=PLANS[planKey];
        $('stripePayBtn').href=plan.stripeUrl;
        $('stripeBtnLabel').textContent='クレジットカードで支払う（'+plan.label+'）';
    }
    // Auto-select plan from contract page
    (()=>{const saved=localStorage.getItem('contractPlan');if(saved&&PLANS[saved]){const radio=$('plan'+(saved==='starter'?'A':'B'));if(radio){radio.checked=true;radio.dispatchEvent(new Event('change'));}}})();
    function updateCreditState(){creditProceedBtn.disabled=!(creditName.value.trim().length>0&&isValidEmail(creditEmail.value.trim()));}
    creditName.addEventListener('input',()=>{updateCreditState();if(creditName.dataset.touched)validateField(creditName,'creditNameError',v=>v.trim().length>0);});
    creditEmail.addEventListener('input',()=>{updateCreditState();if(creditEmail.dataset.touched)validateField(creditEmail,'creditEmailError',v=>isValidEmail(v.trim()));});
    creditName.addEventListener('blur',()=>{creditName.dataset.touched='1';validateField(creditName,'creditNameError',v=>v.trim().length>0);});
    creditEmail.addEventListener('blur',()=>{creditEmail.dataset.touched='1';validateField(creditEmail,'creditEmailError',v=>isValidEmail(v.trim()));});
    creditProceedBtn.addEventListener('click',async()=>{
        let hasError=false;
        if(!creditName.value.trim()){$('creditNameError').classList.add('visible');creditName.classList.add('error');hasError=true;}else{$('creditNameError').classList.remove('visible');creditName.classList.remove('error');}
        if(!isValidEmail(creditEmail.value.trim())){$('creditEmailError').classList.add('visible');creditEmail.classList.add('error');hasError=true;}else{$('creditEmailError').classList.remove('visible');creditEmail.classList.remove('error');}
        if(hasError)return;
        const planKey=getSelectedPlan();const plan=PLANS[planKey];
        const payload={action:'registerPayment',product:plan.name,price:plan.price,customerName:creditName.value.trim(),email:creditEmail.value.trim(),paymentMethod:'クレジットカード',submittedAt:new Date().toISOString()};
        creditProceedBtn.disabled=true;creditProceedBtn.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/></svg> 処理中...';
        if(CHECKOUT_ENDPOINT){try{await fetch(CHECKOUT_ENDPOINT,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload),mode:'no-cors'});}catch(err){console.error('Credit register error:',err);}}
        localStorage.setItem('checkoutEmail',creditEmail.value.trim());localStorage.setItem('checkoutName',creditName.value.trim());localStorage.setItem('checkoutPlan',planKey);
        setTimeout(()=>{$('creditStep1').style.display='none';$('creditStep2').style.display='block';document.querySelectorAll('.plan-card input').forEach(r=>r.disabled=true);document.querySelectorAll('.plan-card').forEach(c=>c.style.cursor='default');updateStripeBtn();},600);
    });
    // Reset
    $('resetFormLink').addEventListener('click',e=>{e.preventDefault();$('resetOverlay').classList.add('open');});
    $('resetCancelBtn').addEventListener('click',()=>{$('resetOverlay').classList.remove('open');});
    $('resetOverlay').addEventListener('click',e=>{if(e.target===e.currentTarget)$('resetOverlay').classList.remove('open');});
    document.addEventListener('keydown',e=>{if(e.key==='Escape'&&$('resetOverlay').classList.contains('open'))$('resetOverlay').classList.remove('open');});
    $('resetConfirmBtn').addEventListener('click',async()=>{
        const btn=$('resetConfirmBtn');btn.disabled=true;btn.textContent='処理中...';
        const name=localStorage.getItem('checkoutName')||creditName.value.trim();const em=localStorage.getItem('checkoutEmail')||creditEmail.value.trim();
        const planKey=getSelectedPlan();const plan=PLANS[planKey];
        if(CHECKOUT_ENDPOINT&&(name||em)){try{await fetch(CHECKOUT_ENDPOINT,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({action:'cancelPayment',product:plan.name,price:plan.price,customerName:name,email:em,submittedAt:new Date().toISOString()}),mode:'no-cors'});}catch(err){console.error('Cancel error:',err);}}
        localStorage.removeItem('checkoutName');localStorage.removeItem('checkoutEmail');localStorage.removeItem('checkoutPlan');location.reload();
    });
    // Auto-fill
    (()=>{const n=localStorage.getItem('contractName')||'';const e=localStorage.getItem('contractEmail')||'';if(n)creditName.value=n;if(e)creditEmail.value=e;if(n||e)updateCreditState();})();
    updateStripeBtn();
    </script>
</body>
</html>
