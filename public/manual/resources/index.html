<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>営業資料 — バク売れLPテンプレ パートナーマニュアル</title>
    <meta name="description" content="バク売れLPテンプレの販売パートナー向け営業資料・各種リンクをまとめています。">
    <meta name="robots" content="noindex, nofollow">
    <meta property="og:title" content="営業資料 — バク売れLPテンプレ パートナーマニュアル">
    <meta property="og:description" content="パートナー向け営業資料・各種リンク一覧。">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="バク売れLPテンプレ">
    <meta property="og:image" content="/bakuure-ogp.png">
    <link rel="icon" href="/bakuure-icon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Noto+Sans+JP:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root{--bg:#FAFAFA;--bg-card:#FFF;--border:#E5E7EB;--border-hover:#D1D5DB;--text-primary:#111827;--text-secondary:#6B7280;--text-muted:#7C8290;--accent:#0852FF;--accent-light:rgba(8,82,255,.08);--accent-subtle:rgba(8,82,255,.04);--success:#10B981;--warning:#F59E0B;--radius-lg:20px}
        *{box-sizing:border-box;margin:0;padding:0}
        body{font-family:'Inter','Noto Sans JP',-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;background:var(--bg);color:var(--text-primary);line-height:1.7;font-size:15px;-webkit-font-smoothing:antialiased;min-height:100vh}
        .ambient-glow{position:fixed;top:-20%;left:50%;transform:translateX(-50%);width:900px;height:600px;background:radial-gradient(ellipse,rgba(8,82,255,.04) 0%,transparent 70%);pointer-events:none;z-index:0}
        .site-header{position:sticky;top:0;z-index:100;background:rgba(255,255,255,.85);backdrop-filter:saturate(180%) blur(20px);-webkit-backdrop-filter:saturate(180%) blur(20px);border-bottom:1px solid var(--border)}
        .header-inner{max-width:1080px;margin:0 auto;padding:14px 24px;display:flex;align-items:center;justify-content:space-between}
        .header-logo img{height:58px}
        .header-label{font-size:13px;font-weight:500;color:var(--text-muted)}
        .main-content{position:relative;z-index:1;max-width:1080px;margin:0 auto;padding:0 24px 100px}
        .hero{padding:64px 0 48px;text-align:center}
        .hero-eyebrow{display:inline-flex;align-items:center;gap:8px;font-size:12px;font-weight:600;letter-spacing:.12em;text-transform:uppercase;color:var(--accent);background:var(--accent-light);padding:6px 16px;border-radius:100px;margin-bottom:20px}
        .hero h1{font-size:clamp(26px,5vw,38px);font-weight:800;letter-spacing:-.03em;line-height:1.2;margin-bottom:12px}
        .hero-sub{font-size:15px;color:var(--text-secondary);max-width:520px;margin:0 auto}
        .tab-nav{display:flex;gap:4px;background:var(--bg-card);border:1px solid var(--border);border-radius:14px;padding:4px;margin-bottom:40px;overflow-x:auto}
        .tab-btn{flex:1;padding:12px 20px;border-radius:10px;font-size:14px;font-weight:600;text-align:center;text-decoration:none;color:var(--text-secondary);background:transparent;border:none;cursor:pointer;font-family:inherit;transition:all .2s;white-space:nowrap;min-width:fit-content}
        .tab-btn.active{background:var(--accent);color:#fff;box-shadow:0 2px 8px rgba(8,82,255,.2)}
        .tab-btn:not(.active):hover{background:var(--accent-subtle);color:var(--accent)}
        .section-title{font-size:20px;font-weight:700;letter-spacing:-.02em;margin-bottom:20px;display:flex;align-items:center;gap:10px;opacity:0;transform:translateY(16px);animation:fadeUp .5s ease forwards}
        .section-title svg{width:20px;height:20px;stroke:var(--accent);fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}

        /* Default resource grid (single col fills) */
        .resource-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px;margin-bottom:56px}
        /* 2-column thumbnail grid for specific categories */
        .resource-grid-2col{display:grid;grid-template-columns:repeat(2,1fr);gap:20px;margin-bottom:56px}

        .resource-card{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius-lg);overflow:hidden;transition:all .3s cubic-bezier(.4,0,.2,1);box-shadow:0 1px 3px rgba(0,0,0,.04);opacity:0;transform:translateY(16px);animation:fadeUp .5s ease forwards}
        .resource-card:hover{border-color:var(--accent);box-shadow:0 16px 40px rgba(8,82,255,.06),0 0 0 1px var(--accent)}
        .rc-thumb{width:100%;aspect-ratio:16/9;background:#f1f5f9;overflow:hidden;position:relative}
        .rc-thumb img{width:100%;height:100%;object-fit:cover;object-position:top;transition:opacity .3s}
        .rc-thumb-placeholder{width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#e0e7ff 0%,#f1f5f9 100%)}
        .rc-thumb-placeholder svg{width:48px;height:48px;stroke:var(--border-hover);fill:none;stroke-width:1.5;stroke-linecap:round;stroke-linejoin:round}
        .rc-body{padding:24px}
        .rc-body-nopad{padding:28px}
        .rc-header{display:flex;align-items:center;gap:14px;margin-bottom:12px}
        .rc-icon{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0;background:var(--accent-light)}
        .rc-icon svg{width:24px;height:24px;stroke:var(--accent);stroke-width:2;stroke-linecap:round;stroke-linejoin:round;fill:none}
        .rc-header h3{font-size:16px;font-weight:700;letter-spacing:-.01em;line-height:1.35}
        .resource-card p{font-size:13px;color:var(--text-secondary);line-height:1.6;margin-bottom:16px}
        .rc-footer{display:flex;align-items:center;justify-content:space-between}
        .rc-tag{font-size:11px;font-weight:600;padding:3px 10px;border-radius:100px;background:var(--accent-light);color:var(--accent)}
        .rc-btn{display:inline-flex;align-items:center;gap:6px;font-size:13px;font-weight:600;color:var(--accent);text-decoration:none;transition:gap .2s}
        .rc-btn:hover{gap:10px}
        .rc-btn svg{width:14px;height:14px;stroke:currentColor;fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}

        /* 関連リンク */
        .link-section{margin-bottom:56px}
        .link-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:16px}
        .link-card{display:block;background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius-lg);overflow:hidden;text-decoration:none;color:inherit;transition:all .3s ease;box-shadow:0 1px 3px rgba(0,0,0,.04)}
        .link-card:hover{border-color:var(--accent);box-shadow:0 8px 24px rgba(8,82,255,.06),0 0 0 1px var(--accent)}
        .link-thumb{width:100%;aspect-ratio:16/9;overflow:hidden;background:#f1f5f9;position:relative}
        .link-thumb img{width:100%;height:100%;object-fit:cover;object-position:top;transition:opacity .3s}
        .link-thumb-placeholder{width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#e0e7ff 0%,#f1f5f9 100%)}
        .link-thumb-placeholder svg{width:36px;height:36px;stroke:var(--border-hover);fill:none;stroke-width:1.5}
        .link-body{padding:18px 20px;display:flex;align-items:center;gap:14px}
        .link-icon{width:36px;height:36px;border-radius:9px;display:flex;align-items:center;justify-content:center;flex-shrink:0;background:var(--accent-light)}
        .link-icon svg{width:18px;height:18px;stroke:var(--accent);fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}
        .link-text{flex:1;min-width:0}
        .link-text h3{font-size:14px;font-weight:700;margin-bottom:2px}
        .link-text p{font-size:12px;color:var(--text-muted);margin-bottom:0}
        .link-arrow{width:28px;height:28px;border-radius:50%;background:var(--accent-subtle);display:flex;align-items:center;justify-content:center;flex-shrink:0}
        .link-arrow svg{width:13px;height:13px;stroke:var(--accent);fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}

        .loading-state{text-align:center;padding:80px 24px}
        .loading-spinner{width:40px;height:40px;border:3px solid var(--border);border-top-color:var(--accent);border-radius:50%;animation:spin .8s linear infinite;margin:0 auto 16px}
        @keyframes spin{to{transform:rotate(360deg)}}
        .loading-state p{font-size:14px;color:var(--text-muted)}
        .empty-state{text-align:center;padding:80px 24px}
        .empty-state h3{font-size:18px;font-weight:700;margin-bottom:8px}
        .empty-state p{font-size:14px;color:var(--text-muted)}
        .site-footer{text-align:center;padding:32px 24px;border-top:1px solid var(--border)}
        .site-footer p{font-size:12px;color:var(--text-muted)}
        @keyframes fadeUp{to{opacity:1;transform:translateY(0)}}
        @media(max-width:768px){.resource-grid{grid-template-columns:1fr}.resource-grid-2col{grid-template-columns:1fr}.link-grid{grid-template-columns:1fr}.hero{padding:48px 0 36px}.main-content{padding:0 16px 60px}.header-inner{padding:14px 16px}}
        @media(max-width:480px){.header-logo img{height:40px}.tab-btn{padding:10px 14px;font-size:13px}}
    </style>
</head>
<body>
    <div class="ambient-glow"></div>
    <header class="site-header">
        <div class="header-inner">
            <div class="header-logo"><a href="/manual/videos/" style="display:flex;align-items:center;text-decoration:none;"><img src="/bakuure-logo.svg" alt="バク売れLPテンプレ"></a></div>
            <span class="header-label">パートナーマニュアル</span>
        </div>
    </header>
    <main class="main-content">
        <section class="hero">
            <p class="hero-eyebrow">Partner Manual</p>
            <h1>営業資料・各種リンク一覧</h1>
            <p class="hero-sub">パートナー様の営業活動にご活用いただける資料をご用意しています。</p>
        </section>
        <nav class="tab-nav">
            <a href="/manual/videos/" class="tab-btn">動画マニュアル</a>
            <a href="/manual/resources/" class="tab-btn active">営業資料</a>
            <a href="/manual/faq/" class="tab-btn">FAQ</a>
        </nav>
        <div id="resourceContainer"></div>
        <div id="loadingState" class="loading-state"><div class="loading-spinner"></div><p>資料一覧を読み込んでいます...</p></div>
        <div id="emptyState" class="empty-state" style="display:none">
            <h3>資料はまだ登録されていません</h3>
            <p>コンテンツが追加されるまでしばらくお待ちください。</p>
        </div>
        <h2 class="section-title" style="animation-delay:.3s"><svg viewBox="0 0 24 24"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg>関連リンク</h2>
        <div class="link-section">
            <div class="link-grid">
                <a href="/contract/" class="link-card" id="linkContract">
                    <div class="link-thumb"><div class="link-thumb-placeholder" id="linkContractPlaceholder"><svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg></div></div>
                    <div class="link-body">
                        <div class="link-icon"><svg viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg></div>
                        <div class="link-text"><h3>ご契約ページ</h3><p>お客様にご案内いただく契約フォームページ</p></div>
                        <div class="link-arrow"><svg viewBox="0 0 24 24"><path d="M7 17L17 7M17 7H7M17 7V17"/></svg></div>
                    </div>
                </a>
                <a href="/user-guide/" class="link-card" id="linkUserGuide">
                    <div class="link-thumb"><div class="link-thumb-placeholder" id="linkUserGuidePlaceholder"><svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 014 4v14a3 3 0 00-3-3H2z"/><path d="M22 3h-6a4 4 0 00-4 4v14a3 3 0 013-3h7z"/></svg></div></div>
                    <div class="link-body">
                        <div class="link-icon"><svg viewBox="0 0 24 24"><path d="M2 3h6a4 4 0 014 4v14a3 3 0 00-3-3H2z"/><path d="M22 3h-6a4 4 0 00-4 4v14a3 3 0 013-3h7z"/></svg></div>
                        <div class="link-text"><h3>ユーザーガイド</h3><p>テンプレート購入者向けのガイドページ</p></div>
                        <div class="link-arrow"><svg viewBox="0 0 24 24"><path d="M7 17L17 7M17 7H7M17 7V17"/></svg></div>
                    </div>
                </a>
            </div>
        </div>
    </main>
    <footer class="site-footer"><p>&copy; 2026 バク売れLPテンプレ &amp; CHAINSODA Co., Ltd. — All rights reserved.</p></footer>
    <script>
    const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTza74lwZCv56xNnhI4fDgEk5zCvq4WAcvNboRGbByVxPLSh-NZLIe8eVdATny0exFPGPW8ew9O7Jm8/pub?gid=380310918&single=true&output=csv';
    const THUMB_CATEGORIES = ['営業資料', 'ランディングページ（LP）', 'ランディングページ(LP)', 'ランディングページ'];

    function parseCSV(text) {
        const rows = []; let cur = []; let field = ''; let inQ = false;
        for (let i = 0; i < text.length; i++) {
            const c = text[i];
            if (inQ) {
                if (c === '"' && text[i+1] === '"') { field += '"'; i++; }
                else if (c === '"') { inQ = false; }
                else { field += c; }
            } else {
                if (c === '"') { inQ = true; }
                else if (c === ',') { cur.push(field); field = ''; }
                else if (c === '\n' || (c === '\r' && text[i+1] === '\n')) {
                    cur.push(field); field = ''; rows.push(cur); cur = [];
                    if (c === '\r') i++;
                } else { field += c; }
            }
        }
        if (field || cur.length) { cur.push(field); rows.push(cur); }
        return rows;
    }

    function escapeHtml(s) { return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }

    function getFileTag(url) {
        if (!url) return '資料';
        const lower = url.toLowerCase();
        if (lower.includes('.pdf')) return 'PDF';
        if (lower.includes('.pptx') || lower.includes('.ppt')) return 'PPTX';
        if (lower.includes('.xlsx') || lower.includes('.xls') || lower.includes('spreadsheets')) return 'XLSX';
        if (lower.includes('.docx') || lower.includes('.doc') || lower.includes('document')) return 'DOCX';
        if (lower.includes('.fig') || lower.includes('figma')) return 'Figma';
        if (lower.includes('drive.google.com') || lower.includes('docs.google.com')) return 'Google';
        return 'リンク';
    }

    /** Screenshot thumbnail via thum.io */
    function getThumbnailUrl(url) {
        if (!url) return '';
        let full = url;
        if (url.startsWith('/')) full = window.location.origin + url;
        return 'https://image.thum.io/get/width/600/crop/380/' + encodeURIComponent(full);
    }

    function isThumbnailCategory(catName) {
        return THUMB_CATEGORIES.some(function(c) { return catName.indexOf(c) !== -1; });
    }

    async function loadResources() {
        const container = document.getElementById('resourceContainer');
        const loading = document.getElementById('loadingState');
        const empty = document.getElementById('emptyState');
        try {
            const res = await fetch(CSV_URL + '&t=' + Date.now());
            if (!res.ok) throw new Error('Fetch failed');
            const text = await res.text();
            const rows = parseCSV(text).slice(1).filter(r => (r[0]||'').trim().toUpperCase() === 'ON');
            loading.style.display = 'none';
            if (rows.length === 0) { empty.style.display = 'block'; return; }

            const categories = {};
            const catOrder = [];
            rows.forEach(function(r) {
                const large = (r[1] || 'その他').trim();
                if (!categories[large]) { categories[large] = []; catOrder.push(large); }
                categories[large].push({
                    medium: (r[2] || '').trim(),
                    small: (r[3] || '').trim(),
                    detail: (r[4] || '').trim(),
                    url: (r[5] || '').trim(),
                    desc: (r[6] || '').trim()
                });
            });

            let catIdx = 0;
            catOrder.forEach(function(catName) {
                const items = categories[catName];
                const use2col = isThumbnailCategory(catName);

                const titleEl = document.createElement('h2');
                titleEl.className = 'section-title';
                titleEl.style.animationDelay = (catIdx * 0.08) + 's';
                titleEl.innerHTML = '<svg viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>' + escapeHtml(catName);
                container.appendChild(titleEl);

                const grid = document.createElement('div');
                grid.className = use2col ? 'resource-grid-2col' : 'resource-grid';
                container.appendChild(grid);

                items.forEach(function(item, i) {
                    const card = document.createElement('div');
                    card.className = 'resource-card';
                    card.style.animationDelay = (catIdx * 0.08 + i * 0.06) + 's';

                    const title = item.medium || item.small || item.detail || '資料';
                    const description = item.detail || item.desc || '';
                    const tag = getFileTag(item.url);
                    const hasUrl = item.url && item.url !== '#';

                    let html = '';

                    // Thumbnail for 2-col categories
                    if (use2col && hasUrl) {
                        const thumbUrl = getThumbnailUrl(item.url);
                        html += '<div class="rc-thumb">'
                            + '<img src="' + escapeHtml(thumbUrl) + '" alt="" loading="lazy" onerror="this.parentElement.innerHTML=\'<div class=rc-thumb-placeholder><svg viewBox=&quot;0 0 24 24&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;><rect x=&quot;2&quot; y=&quot;3&quot; width=&quot;20&quot; height=&quot;14&quot; rx=&quot;2&quot;/><line x1=&quot;8&quot; y1=&quot;21&quot; x2=&quot;16&quot; y2=&quot;21&quot;/><line x1=&quot;12&quot; y1=&quot;17&quot; x2=&quot;12&quot; y2=&quot;21&quot;/></svg></div>\'">'
                            + '</div>';
                    } else if (use2col) {
                        html += '<div class="rc-thumb"><div class="rc-thumb-placeholder"><svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg></div></div>';
                    }

                    // Body
                    html += '<div class="' + (use2col ? 'rc-body' : 'rc-body-nopad') + '">';

                    if (!use2col) {
                        html += '<div class="rc-header">'
                            + '<div class="rc-icon"><svg viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg></div>'
                            + '<h3>' + escapeHtml(title) + '</h3>'
                            + '</div>';
                    } else {
                        html += '<h3 style="font-size:15px;font-weight:700;margin-bottom:8px;letter-spacing:-.01em">' + escapeHtml(title) + '</h3>';
                    }

                    if (description) html += '<p>' + escapeHtml(description) + '</p>';
                    else if (item.desc) html += '<p>' + escapeHtml(item.desc) + '</p>';

                    html += '<div class="rc-footer">';
                    html += '<span class="rc-tag">' + escapeHtml(tag) + '</span>';
                    if (hasUrl) {
                        html += '<a href="' + escapeHtml(item.url) + '" target="_blank" rel="noopener" class="rc-btn">アクセス<svg viewBox="0 0 24 24"><path d="M5 12h14"/><path d="M12 5l7 7-7 7"/></svg></a>';
                    } else {
                        html += '<span style="font-size:12px;color:var(--text-muted)">準備中</span>';
                    }
                    html += '</div></div>';

                    card.innerHTML = html;
                    grid.appendChild(card);
                });

                catIdx++;
            });
        } catch (err) {
            console.error('Resource CSV load error:', err);
            loading.innerHTML = '<p style="color:var(--text-muted)">資料一覧の読み込みに失敗しました。ページを再読み込みしてください。</p>';
        }
    }

    /* Set thumbnail images for 関連リンク using thum.io */
    function loadLinkThumbnails() {
        var links = [
            { id: 'linkContractPlaceholder', path: '/contract/' },
            { id: 'linkUserGuidePlaceholder', path: '/user-guide/' }
        ];
        links.forEach(function(l) {
            var el = document.getElementById(l.id);
            if (!el) return;
            var parent = el.parentElement;
            var thumbUrl = getThumbnailUrl(l.path);
            var img = new Image();
            img.src = thumbUrl;
            img.alt = '';
            img.loading = 'lazy';
            img.onload = function() { parent.innerHTML = ''; parent.appendChild(img); };
        });
    }

    loadResources();
    loadLinkThumbnails();
    </script>
</body>
</html>
