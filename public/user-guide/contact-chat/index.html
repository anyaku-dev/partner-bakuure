<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIチャットサポート — バク売れLPテンプレ</title>
    <meta name="description" content="バク売れLPテンプレのAIチャットサポート。テンプレートの使い方やカスタマイズ方法など、AIがお答えします。">
    <meta name="robots" content="noindex, nofollow">
    <meta property="og:title" content="AIチャットサポート — バク売れLPテンプレ">
    <meta property="og:description" content="テンプレートの使い方やカスタマイズ方法など、AIがお答えします。">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="バク売れLPテンプレ">
    <meta property="og:image" content="/bakuure-ogp.png">
    <link rel="icon" href="/bakuure-icon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Noto+Sans+JP:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <style>
        :root{--bg:#FAFAFA;--bg-card:#FFF;--border:#E5E7EB;--border-hover:#D1D5DB;--text-primary:#111827;--text-secondary:#6B7280;--text-muted:#7C8290;--accent:#0852FF;--accent-light:rgba(8,82,255,.08);--accent-subtle:rgba(8,82,255,.04);--success:#10B981;--radius-lg:20px}
        *{box-sizing:border-box;margin:0;padding:0}
        body{font-family:'Inter','Noto Sans JP',-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;background:var(--bg);color:var(--text-primary);line-height:1.7;font-size:15px;-webkit-font-smoothing:antialiased;height:100vh;display:flex;flex-direction:column;overflow:hidden}
        .site-header{z-index:100;background:rgba(255,255,255,.85);backdrop-filter:saturate(180%) blur(20px);-webkit-backdrop-filter:saturate(180%) blur(20px);border-bottom:1px solid var(--border);flex-shrink:0}
        .header-inner{max-width:960px;margin:0 auto;padding:14px 24px;display:flex;align-items:center;justify-content:space-between}
        .header-logo img{height:48px}
        .header-nav a{font-size:13px;font-weight:500;color:var(--text-muted);text-decoration:none;display:flex;align-items:center;gap:4px;transition:color .2s}
        .header-nav a:hover{color:var(--accent)}
        .header-nav svg{width:14px;height:14px;stroke:currentColor;fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}
        .chat-container{flex:1;display:flex;flex-direction:column;max-width:780px;width:100%;margin:0 auto;overflow:hidden}
        .chat-messages{flex:1;overflow-y:auto;padding:24px 24px 16px;display:flex;flex-direction:column;gap:16px;scroll-behavior:smooth}
        .msg{display:flex;gap:12px;max-width:88%;animation:msgIn .3s ease}
        .msg.user{align-self:flex-end;flex-direction:row-reverse}
        .msg-avatar{width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0;font-size:18px;color:var(--accent)}
        .msg.assistant .msg-avatar{background:var(--accent-light);color:var(--accent)}
        .msg.user .msg-avatar{background:rgba(16,185,129,.08);color:var(--success)}
        .msg-bubble{padding:14px 18px;border-radius:18px;font-size:14px;line-height:1.7;word-break:break-word}
        .msg.assistant .msg-bubble{background:var(--bg-card);border:1px solid var(--border);border-bottom-left-radius:4px}
        .msg.user .msg-bubble{background:var(--accent);color:#fff;border-bottom-right-radius:4px}
        .msg-bubble p{margin-bottom:8px;font-size:14px}
        .msg-bubble p:last-child{margin-bottom:0}
        .msg-bubble h3{font-size:14px;font-weight:700;margin:12px 0 4px}
        .msg-bubble h3:first-child{margin-top:0}
        .msg-bubble code{background:rgba(0,0,0,.06);padding:2px 6px;border-radius:4px;font-size:13px;font-family:'SF Mono','Fira Code',monospace}
        .msg.user .msg-bubble code{background:rgba(255,255,255,.2)}
        .msg-bubble pre{background:#1E293B;border-radius:10px;padding:14px;margin:8px 0;overflow-x:auto}
        .msg-bubble pre code{background:none;color:#E2E8F0;display:block;white-space:pre;padding:0;font-size:13px}
        .msg-bubble ul,.msg-bubble ol{padding-left:20px;margin:8px 0;font-size:14px}
        .msg-bubble li{margin-bottom:4px;font-size:14px}
        .msg-bubble strong{font-weight:600;font-size:inherit}
        .typing-indicator{display:flex;gap:4px;padding:14px 18px}
        .typing-indicator span{width:8px;height:8px;border-radius:50%;background:var(--border-hover);animation:bounce 1.4s infinite}
        .typing-indicator span:nth-child(2){animation-delay:.2s}
        .typing-indicator span:nth-child(3){animation-delay:.4s}
        @keyframes bounce{0%,60%,100%{transform:translateY(0)}30%{transform:translateY(-6px)}}
        .chat-input-area{flex-shrink:0;border-top:1px solid var(--border);background:var(--bg-card);padding:16px 24px 24px}
        .chat-form{display:flex;gap:10px;max-width:780px;margin:0 auto}
        .chat-input{flex:1;padding:14px 18px;border:1px solid var(--border);border-radius:14px;font-size:14px;font-family:inherit;background:var(--bg);color:var(--text-primary);outline:none;resize:none;min-height:48px;max-height:120px;line-height:1.5;transition:border-color .2s}
        .chat-input:focus{border-color:var(--accent);box-shadow:0 0 0 3px var(--accent-subtle)}
        .chat-input::placeholder{color:var(--text-muted)}
        .chat-send{width:48px;height:48px;border-radius:14px;background:var(--accent);border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s;flex-shrink:0}
        .chat-send:hover{background:#063dd9;transform:scale(1.04)}
        .chat-send:disabled{opacity:.4;cursor:not-allowed;transform:none}
        .chat-send svg{width:20px;height:20px;stroke:#fff;fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}
        .suggested-questions{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:12px;max-width:780px;margin-left:auto;margin-right:auto}
        .suggest-btn{display:inline-flex;align-items:center;gap:6px;padding:8px 14px;border-radius:100px;border:1px solid var(--border);background:var(--bg-card);font-size:12px;font-weight:500;color:var(--text-secondary);cursor:pointer;transition:all .2s;font-family:inherit;white-space:nowrap}
        .suggest-btn:hover{border-color:var(--accent);color:var(--accent);background:var(--accent-subtle)}
        .suggest-btn svg{width:14px;height:14px;stroke:currentColor;fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}
        @keyframes msgIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
        .site-footer{flex-shrink:0;text-align:center;padding:12px 24px;border-top:1px solid var(--border);background:var(--bg)}
        .site-footer p{font-size:11px;color:var(--text-muted)}
        @media(max-width:768px){.chat-messages{padding:16px 16px 12px}.chat-input-area{padding:12px 16px 20px}.header-inner{padding:12px 16px}}
        @media(max-width:480px){.header-logo img{height:36px}.msg{max-width:92%}.suggested-questions{padding:0 16px}}
    </style>
</head>
<body>
    <header class="site-header">
        <div class="header-inner">
            <div class="header-logo"><a href="/user-guide/" style="display:flex;align-items:center;text-decoration:none;"><img src="/bakuure-logo.svg" alt="バク売れLPテンプレ"></a></div>
            <nav class="header-nav"><a href="/user-guide/"><svg viewBox="0 0 24 24"><path d="M15 18l-6-6 6-6"/></svg>ユーザーガイドに戻る</a></nav>
        </div>
    </header>
    <div class="chat-container">
        <div class="chat-messages" id="chatMessages">
            <div class="msg assistant">
                <div class="msg-avatar"><i class="fa-solid fa-headset"></i></div>
                <div class="msg-bubble">
                    <p>こんにちは！<strong>バク売れLPテンプレ AIサポート</strong>です。</p>
                    <p>テンプレートの使い方・カスタマイズ方法・公開手順など、何でもお気軽にご質問ください。</p>
                </div>
            </div>
        </div>
        <div class="chat-input-area">
            <div class="suggested-questions" id="suggestions">
                <button class="suggest-btn" onclick="askSuggested(this)"><svg viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="9" y1="21" x2="9" y2="9"/></svg>テンプレートのカスタマイズ方法は？</button>
                <button class="suggest-btn" onclick="askSuggested(this)"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 015.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>LPをVercelで公開する方法は？</button>
                <button class="suggest-btn" onclick="askSuggested(this)"><svg viewBox="0 0 24 24"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>レスポンシブ対応の確認ポイントは？</button>
                <button class="suggest-btn" onclick="askSuggested(this)"><svg viewBox="0 0 24 24"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 013 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>色やフォントの変え方は？</button>
            </div>
            <form class="chat-form" id="chatForm" onsubmit="handleSend(event)">
                <textarea class="chat-input" id="chatInput" placeholder="質問を入力してください…" rows="1" onkeydown="handleKeyDown(event)" oninput="autoResize(this)"></textarea>
                <button class="chat-send" type="submit" id="sendBtn"><svg viewBox="0 0 24 24"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg></button>
            </form>
        </div>
    </div>
    <footer class="site-footer"><p>&copy; 2026 バク売れLPテンプレ — All rights reserved.</p></footer>
    <script>
    const SYSTEM_PROMPT=`あなたは「バク売れLPテンプレ」の公式AIサポートアシスタントです。

【サービス概要】
バク売れLPテンプレは、株式会社CHAINSODAが提供するLPデザインテンプレート配布サービスです。
- スタータープラン（¥55,000税込）：LPテンプレート一式（HTML/CSS/JS/画像）
- 集客強化プラン（¥110,000税込）：LPテンプレート一式＋バナーデザインテンプレート素材（PSD/Figma/PNG）

【対応範囲】
- Figmaの基本的な操作方法（レイヤー操作、テキスト編集、画像配置、エクスポートなど）
- LPの実装方法に関する簡単なアイディアやヒント
- テンプレートの基本的な使い方
- LP公開に関する一般的なアドバイス（Vercel / Netlifyなどの概要）
- デザインのカスタマイズの方向性（色変更、フォント変更などの考え方）

【対応しない範囲】
- Figmaの詳細な操作手順やステップバイステップのチュートリアル
- 具体的なコーディング作業（コード全文の提供など）
- 外部ツールの詳細な設定手順（GA4の設定手順などはサポート対象外）
- 契約内容や料金に関する質問（→ お問い合わせフォームへ誘導）

【回答ルール】
- 日本語で簡潔に、わかりやすく回答してください
- Markdownの記号（**、##、***など）は使わないでください。プレーンテキストで回答してください
- 箇条書きには「・」や「→」などの日本語記号を使ってください
- 大まかな方向性やアイディアのヒントを提示し、詳しくは公式ドキュメントや専門リソースの参照を促してください
- 詳細な操作手順を求められた場合は「詳しい操作手順については、Figma公式ヘルプやチュートリアル動画をご覧ください」等と案内してください
- 契約・料金の質問にはお問い合わせフォーム（/user-guide/contact-form/）への誘導をしてください
- 不明な場合は「お問い合わせフォームからスタッフにお尋ねください」と案内してください`;

    const chatHistory=[];
    let isLoading=false;

    function addMessage(role,text){
        const container=document.getElementById('chatMessages');
        const div=document.createElement('div');
        div.className='msg '+role;
        const avatar=document.createElement('div');
        avatar.className='msg-avatar';
        if(role==='assistant'){avatar.innerHTML='<i class="fa-solid fa-headset"></i>';}else{avatar.innerHTML='<i class="fa-solid fa-circle-user"></i>';}
        const bubble=document.createElement('div');
        bubble.className='msg-bubble';
        bubble.innerHTML=formatMessage(text);
        div.appendChild(avatar);
        div.appendChild(bubble);
        container.appendChild(div);
        container.scrollTop=container.scrollHeight;
        return div;
    }

    function addTypingIndicator(){
        const container=document.getElementById('chatMessages');
        const div=document.createElement('div');
        div.className='msg assistant';
        div.id='typingIndicator';
        div.innerHTML='<div class="msg-avatar"><i class="fa-solid fa-headset"></i></div><div class="msg-bubble"><div class="typing-indicator"><span></span><span></span><span></span></div></div>';
        container.appendChild(div);
        container.scrollTop=container.scrollHeight;
    }

    function removeTypingIndicator(){
        const el=document.getElementById('typingIndicator');
        if(el)el.remove();
    }

    function formatMessage(text){
        // Code blocks (fenced)
        text=text.replace(/```(\w*)\n([\s\S]*?)```/g,function(m,lang,code){return '\n<pre><code>'+escapeHtml(code.trim())+'</code></pre>\n';});
        // Inline code
        text=text.replace(/`([^`]+)`/g,'<code>$1</code>');
        // Bold
        text=text.replace(/\*\*([^*]+)\*\*/g,'<strong>$1</strong>');
        // Remove remaining single asterisks used as bullet markers at line start
        text=text.replace(/^\*\s+/gm,'• ');
        // Italic (single asterisk wrapping)
        text=text.replace(/(?<![\w*])\*([^*\n]+)\*(?![\w*])/g,'<em>$1</em>');
        // Markdown headers ### → bold line
        text=text.replace(/^#{1,4}\s+(.+)$/gm,'<strong>$1</strong>');
        // Split by double newline for paragraphs
        var parts=text.split(/\n\n+/);
        var result='';
        for(var i=0;i<parts.length;i++){
            var p=parts[i].trim();
            if(!p)continue;
            if(p.startsWith('<pre>')){
                result+=p;
            }else{
                // Convert single newlines to <br>
                p=p.replace(/\n/g,'<br>');
                result+='<p>'+p+'</p>';
            }
        }
        if(!result)result='<p>'+text+'</p>';
        return result;
    }

    function escapeHtml(str){return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}

    async function sendMessage(userText){
        if(isLoading||!userText.trim())return;
        isLoading=true;
        document.getElementById('sendBtn').disabled=true;
        document.getElementById('suggestions').style.display='none';

        addMessage('user',userText);
        chatHistory.push({role:'user',parts:[{text:userText}]});

        addTypingIndicator();

        try{
            const contents=[{role:'user',parts:[{text:SYSTEM_PROMPT}]},{role:'model',parts:[{text:'承知しました。バク売れLPテンプレのAIサポートとして対応いたします。'}]},...chatHistory];
            const response=await fetch('/api/gemini-proxy',{
                method:'POST',
                headers:{'Content-Type':'application/json'},
                body:JSON.stringify({contents})
            });
            const data=await response.json();
            removeTypingIndicator();

            if(data.candidates&&data.candidates[0]&&data.candidates[0].content){
                const reply=data.candidates[0].content.parts[0].text;
                addMessage('assistant',reply);
                chatHistory.push({role:'model',parts:[{text:reply}]});
            }else{
                addMessage('assistant','申し訳ございません。回答を生成できませんでした。お手数ですが、もう一度お試しいただくか、<a href="/user-guide/contact-form/" style="color:var(--accent);">お問い合わせフォーム</a>からご連絡ください。');
            }
        }catch(err){
            removeTypingIndicator();
            console.error('Chat error:',err);
            addMessage('assistant','通信エラーが発生しました。ネットワーク接続をご確認のうえ、もう一度お試しください。');
        }finally{
            isLoading=false;
            document.getElementById('sendBtn').disabled=false;
        }
    }

    function handleSend(e){
        e.preventDefault();
        const input=document.getElementById('chatInput');
        const text=input.value.trim();
        if(!text)return;
        input.value='';
        input.style.height='auto';
        sendMessage(text);
    }

    function handleKeyDown(e){
        if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();handleSend(e);}
    }

    function autoResize(el){
        el.style.height='auto';
        el.style.height=Math.min(el.scrollHeight,120)+'px';
    }

    function askSuggested(btn){
        sendMessage(btn.textContent.trim());
    }
    </script>
</body>
</html>
